CREATE DATABASE QuanLyDuAn
CREATE TABLE ChucVu(
MaChucVu INT PRIMARY KEY,
TenChucVu NVARCHAR(50) NOT NULL UNIQUE
)
CREATE TABLE PhongBan(
MaPhongBan INT PRIMARY KEY,
TenPhongBan NVARCHAR(50) NOT NULL UNIQUE
)
CREATE TABLE NhanVien(
MaNhanVien INT PRIMARY KEY,
HoTen NVARCHAR(50) NOT NULL,
NgaySinh DATE NOT NULL,
MaChucVu INT NOT NULL REFERENCES ChucVu(MaChucVu),
MaPhongBan INT NOT NULL REFERENCES PhongBan(MaPhongBan)
)
CREATE TABLE DuAn(
MaDuAn INT PRIMARY KEY,
TenDuAn NVARCHAR(50) NOT NULL UNIQUE,
KinhPhi FLOAT NOT NULL,
NgayBatDau DATE NOT NULL,
NgayKetThuc DATE,
)
CREATE TABLE VaiTro(
MaVaiTro INT PRIMARY KEY,
TenVaiTro NVARCHAR(50) NOT NULL UNIQUE
)
CREATE TABLE NhanVienDuAn(
MaDuAn INT NOT NULL REFERENCES DuAn(MaDuAn),
MaNhanVien INT NOT NULL REFERENCES NhanVien(MaNhanVien),
MaVaiTro INT NOT NULL REFERENCES VaiTro(MaVaiTro)
)
ALTER TABLE NhanVienDuAn
ADD CONSTRAINT PK_NhanVienDuAn PRIMARY KEY(MaDuAn,MaNhanVien)
INSERT ChucVu VALUES (1,N'Trưởng phòng')
INSERT ChucVu VALUES (2,N'Nhân viên')
INSERT PhongBan VALUES (1,N'Phòng 1')
INSERT PhongBan VALUES (2,N'Phòng 2')
INSERT NhanVien VALUES (1,N'LÊ AN',N'01/01/2000',1,1)
INSERT NhanVien VALUES (2,N'LÊ BÌNH',N'01/01/2001',2,2)
INSERT DuAn VALUES (1,N'CREATE DATABASE',12000000,N'01/01/2022',N'01/05/2022')
INSERT DuAn VALUES (2,N'DATA STRUCTURE AND ALGORITHM',15000000,N'02/01/2022',N'03/01/2022')
INSERT VaiTro VALUES (1,N'Trưởng dự án')
INSERT VaiTro VALUES (2,N'Nhân viên dự án')
INSERT NhanVienDuAn VALUES (1,1,1)
INSERT NhanVienDuAn VALUES (2,1,1)
INSERT NhanVienDuAn VALUES (2,2,2)
INSERT NhanVienDuAn VALUES (1,2,1)

--Tìm số dự án 1 nhân viên tham gia, hiển thị thông tin
SELECT NhanVien.MaNhanVien,HoTen,NgaySinh,COUNT (MaDuAn) AS SoDuAnThamGia
FROM NhanVien 
INNER JOIN NhanVienDuAn 
ON NhanVien.MaNhanVien = NhanVienDuAn.MaNhanVien
GROUP BY NhanVien.MaNhanVien,HoTen,NgaySinh
